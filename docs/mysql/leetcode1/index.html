
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>leetcode SQL 入门 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-treeview/style.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    1. 常见算法
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../chapter1/section1/">
            
                <a href="../../chapter1/section1/">
            
                    
                    动态规划
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../chapter1/section2/">
            
                <a href="../../chapter1/section2/">
            
                    
                    回溯
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../../chapter1/section3/">
            
                <a href="../../chapter1/section3/">
            
                    
                    bfs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../../chapter1/section4/">
            
                <a href="../../chapter1/section4/">
            
                    
                    滑动窗口
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../../chapter1/section5/">
            
                <a href="../../chapter1/section5/">
            
                    
                    树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../../chapter1/section6/">
            
                <a href="../../chapter1/section6/">
            
                    
                    图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../../chapter1/section7/">
            
                <a href="../../chapter1/section7/">
            
                    
                    链表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../../chapter1/section8/">
            
                <a href="../../chapter1/section8/">
            
                    
                    子序列（动态规划）
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../../chapter1/section9/">
            
                <a href="../../chapter1/section9/">
            
                    
                    数据结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../../chapter1/section10/">
            
                <a href="../../chapter1/section10/">
            
                    
                    二分搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../../chapter1/section11/">
            
                <a href="../../chapter1/section11/">
            
                    
                    随机
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../../chapter1/section12/">
            
                <a href="../../chapter1/section12/">
            
                    
                    去重
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../../chapter1/section13/">
            
                <a href="../../chapter1/section13/">
            
                    
                    双指针技巧
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../../chapter1/section14/">
            
                <a href="../../chapter1/section14/">
            
                    
                    其它技巧
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../../chapter1/section15/">
            
                <a href="../../chapter1/section15/">
            
                    
                    数学
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    2. 牛客题霸-模板速刷TOP101
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../../chapter2/section1/">
            
                <a href="../../chapter2/section1/">
            
                    
                    链表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../../chapter2/section2/">
            
                <a href="../../chapter2/section2/">
            
                    
                    二分查找/排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../../chapter2/section3/">
            
                <a href="../../chapter2/section3/">
            
                    
                    二叉树
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../../chapter2/section4/">
            
                <a href="../../chapter2/section4/">
            
                    
                    堆/栈/队列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../../chapter2/section5/">
            
                <a href="../../chapter2/section5/">
            
                    
                    哈希
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../../chapter2/section6/">
            
                <a href="../../chapter2/section6/">
            
                    
                    递归/回溯
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../../chapter2/section7/">
            
                <a href="../../chapter2/section7/">
            
                    
                    动态规划
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../../chapter2/section8/">
            
                <a href="../../chapter2/section8/">
            
                    
                    字符串
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../../chapter2/section9/">
            
                <a href="../../chapter2/section9/">
            
                    
                    双指针
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../../chapter2/section10/">
            
                <a href="../../chapter2/section10/">
            
                    
                    贪心算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../../chapter2/section11/">
            
                <a href="../../chapter2/section11/">
            
                    
                    模拟
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    3. 笔试
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../chapter3/section1/">
            
                <a href="../../chapter3/section1/">
            
                    
                    格尔
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../../chapter3/section2/">
            
                <a href="../../chapter3/section2/">
            
                    
                    360
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../../chapter3/section3/">
            
                <a href="../../chapter3/section3/">
            
                    
                    兴业数金
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../../chapter3/section4/">
            
                <a href="../../chapter3/section4/">
            
                    
                    华为机试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    4. leetcode
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../chapter4/section1/">
            
                <a href="../../chapter4/section1/">
            
                    
                    双指针
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    5. 算法练习
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../../chapter5/section1/">
            
                <a href="../../chapter5/section1/">
            
                    
                    数学
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../../chapter5/section2/">
            
                <a href="../../chapter5/section2/">
            
                    
                    排序算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../../chapter5/section3/">
            
                <a href="../../chapter5/section3/">
            
                    
                    字符串
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../../chapter5/section4/">
            
                <a href="../../chapter5/section4/">
            
                    
                    递归算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../../chapter5/section5/">
            
                <a href="../../chapter5/section5/">
            
                    
                    动态规划
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../../chapter5/section6/">
            
                <a href="../../chapter5/section6/">
            
                    
                    回溯算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../../chapter5/section7/">
            
                <a href="../../chapter5/section7/">
            
                    
                    精度算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="../../chapter5/section8/">
            
                <a href="../../chapter5/section8/">
            
                    
                    贪心算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    6. 蓝桥杯
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../../chapter6/section1/">
            
                <a href="../../chapter6/section1/">
            
                    
                    入门练习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../../chapter6/section2/">
            
                <a href="../../chapter6/section2/">
            
                    
                    基础练习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../../chapter6/section3/">
            
                <a href="../../chapter6/section3/">
            
                    
                    进阶练习
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    7. sql练习
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.8.1" data-path="./">
            
                <a href="./">
            
                    
                    leetcode SQL 入门
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >leetcode SQL 入门</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div class="treeview__container"><div class="treeview__container-title"><span class="treeview__main-title">Treeview</span><span class="treeview__copyright">Copyright &#xA9; qgao 2021-* all right reserved, powered by <a href="https://github.com/aleen42" target="_blank">aleen42</a></span></div><ul>
<li><div><a href="#&#x4E00;&#x3001;&#x9009;&#x62E9;">&#x4E00;&#x3001;&#x9009;&#x62E9;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#595-&#x5927;&#x7684;&#x56FD;&#x5BB6;">595. &#x5927;&#x7684;&#x56FD;&#x5BB6;</a><i></i></div></li>
<li><div><a href="#1757-&#x53EF;&#x56DE;&#x6536;&#x4E14;&#x4F4E;&#x8102;&#x7684;&#x4EA7;&#x54C1;">1757. &#x53EF;&#x56DE;&#x6536;&#x4E14;&#x4F4E;&#x8102;&#x7684;&#x4EA7;&#x54C1;</a><i></i></div></li>
<li><div><a href="#584-&#x5BFB;&#x627E;&#x7528;&#x6237;&#x63A8;&#x8350;&#x4EBA;">584. &#x5BFB;&#x627E;&#x7528;&#x6237;&#x63A8;&#x8350;&#x4EBA;</a><i></i></div></li>
<li><div><a href="#183-&#x4ECE;&#x4E0D;&#x8BA2;&#x8D2D;&#x7684;&#x5BA2;&#x6237;">183. &#x4ECE;&#x4E0D;&#x8BA2;&#x8D2D;&#x7684;&#x5BA2;&#x6237;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x4E8C;&#x3001;&#x6392;&#x5E8F;-amp-&#x4FEE;&#x6539;">&#x4E8C;&#x3001;&#x6392;&#x5E8F; &amp; &#x4FEE;&#x6539;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#1873-&#x8BA1;&#x7B97;&#x7279;&#x6B8A;&#x5956;&#x91D1;">1873. &#x8BA1;&#x7B97;&#x7279;&#x6B8A;&#x5956;&#x91D1;</a><i></i></div></li>
<li><div><a href="#627-&#x53D8;&#x66F4;&#x6027;&#x522B;">627. &#x53D8;&#x66F4;&#x6027;&#x522B;</a><i></i></div></li>
<li><div><a href="#196-&#x5220;&#x9664;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;">196. &#x5220;&#x9664;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x4E09;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x51FD;&#x6570;&#x6B63;&#x5219;">&#x4E09;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x51FD;&#x6570;/&#x6B63;&#x5219;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#1667-&#x4FEE;&#x590D;&#x8868;&#x4E2D;&#x7684;&#x540D;&#x5B57;">1667. &#x4FEE;&#x590D;&#x8868;&#x4E2D;&#x7684;&#x540D;&#x5B57;</a><i></i></div></li>
<li><div><a href="#1484-&#x6309;&#x65E5;&#x671F;&#x5206;&#x7EC4;&#x9500;&#x552E;&#x4EA7;&#x54C1;">1484. &#x6309;&#x65E5;&#x671F;&#x5206;&#x7EC4;&#x9500;&#x552E;&#x4EA7;&#x54C1;</a><i></i></div></li>
<li><div><a href="#1527-&#x60A3;&#x67D0;&#x79CD;&#x75BE;&#x75C5;&#x7684;&#x60A3;&#x8005;">1527. &#x60A3;&#x67D0;&#x79CD;&#x75BE;&#x75C5;&#x7684;&#x60A3;&#x8005;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x56DB;&#x3001;&#x7EC4;&#x5408;&#x67E5;&#x8BE2;-amp-&#x6307;&#x5B9A;&#x9009;&#x53D6;">&#x56DB;&#x3001;&#x7EC4;&#x5408;&#x67E5;&#x8BE2; &amp; &#x6307;&#x5B9A;&#x9009;&#x53D6;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#1965-&#x4E22;&#x5931;&#x4FE1;&#x606F;&#x7684;&#x96C7;&#x5458;">1965. &#x4E22;&#x5931;&#x4FE1;&#x606F;&#x7684;&#x96C7;&#x5458;</a><i></i></div></li>
<li><div><a href="#1795-&#x6BCF;&#x4E2A;&#x4EA7;&#x54C1;&#x5728;&#x4E0D;&#x540C;&#x5546;&#x5E97;&#x7684;&#x4EF7;&#x683C;">1795. &#x6BCF;&#x4E2A;&#x4EA7;&#x54C1;&#x5728;&#x4E0D;&#x540C;&#x5546;&#x5E97;&#x7684;&#x4EF7;&#x683C;</a><i></i></div></li>
<li><div><a href="#608-&#x6811;&#x8282;&#x70B9;">608. &#x6811;&#x8282;&#x70B9;</a><i></i></div></li>
<li><div><a href="#176-&#x7B2C;&#x4E8C;&#x9AD8;&#x7684;&#x85AA;&#x6C34;">176. &#x7B2C;&#x4E8C;&#x9AD8;&#x7684;&#x85AA;&#x6C34;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x4E94;&#x3001;&#x5408;&#x5E76;">&#x4E94;&#x3001;&#x5408;&#x5E76;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#175-&#x7EC4;&#x5408;&#x4E24;&#x4E2A;&#x8868;">175. &#x7EC4;&#x5408;&#x4E24;&#x4E2A;&#x8868;</a><i></i></div></li>
<li><div><a href="#1581-&#x8FDB;&#x5E97;&#x5374;&#x672A;&#x8FDB;&#x884C;&#x8FC7;&#x4EA4;&#x6613;&#x7684;&#x987E;&#x5BA2;">1581. &#x8FDB;&#x5E97;&#x5374;&#x672A;&#x8FDB;&#x884C;&#x8FC7;&#x4EA4;&#x6613;&#x7684;&#x987E;&#x5BA2;</a><i></i></div></li>
<li><div><a href="#1148-&#x6587;&#x7AE0;&#x6D4F;&#x89C8;-i">1148. &#x6587;&#x7AE0;&#x6D4F;&#x89C8; I</a><i></i></div></li>
<li><div><a href="#197-&#x4E0A;&#x5347;&#x7684;&#x6E29;&#x5EA6;">197. &#x4E0A;&#x5347;&#x7684;&#x6E29;&#x5EA6;</a><i></i></div></li>
<li><div><a href="#607-&#x9500;&#x552E;&#x5458;">607. &#x9500;&#x552E;&#x5458;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x516D;&#x3001;&#x8BA1;&#x7B97;&#x51FD;&#x6570;">&#x516D;&#x3001;&#x8BA1;&#x7B97;&#x51FD;&#x6570;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#1141-&#x67E5;&#x8BE2;&#x8FD1;30&#x5929;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6570;">1141. &#x67E5;&#x8BE2;&#x8FD1;30&#x5929;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6570;</a><i></i></div></li>
<li><div><a href="#1693-&#x6BCF;&#x5929;&#x7684;&#x9886;&#x5BFC;&#x548C;&#x5408;&#x4F19;&#x4EBA;">1693. &#x6BCF;&#x5929;&#x7684;&#x9886;&#x5BFC;&#x548C;&#x5408;&#x4F19;&#x4EBA;</a><i></i></div></li>
<li><div><a href="#1729-&#x6C42;&#x5173;&#x6CE8;&#x8005;&#x7684;&#x6570;&#x91CF;">1729. &#x6C42;&#x5173;&#x6CE8;&#x8005;&#x7684;&#x6570;&#x91CF;</a><i></i></div></li>
<li><div><a href="#586-&#x8BA2;&#x5355;&#x6700;&#x591A;&#x7684;&#x5BA2;&#x6237;">586. &#x8BA2;&#x5355;&#x6700;&#x591A;&#x7684;&#x5BA2;&#x6237;</a><i></i></div></li>
<li><div><a href="#511-&#x6E38;&#x620F;&#x73A9;&#x6CD5;&#x5206;&#x6790;-i">511. &#x6E38;&#x620F;&#x73A9;&#x6CD5;&#x5206;&#x6790; I</a><i></i></div></li>
<li><div><a href="#1890-2020&#x5E74;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x767B;&#x5F55;">1890. 2020&#x5E74;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x767B;&#x5F55;</a><i></i></div></li>
<li><div><a href="#1741-&#x67E5;&#x627E;&#x6BCF;&#x4E2A;&#x5458;&#x5DE5;&#x82B1;&#x8D39;&#x7684;&#x603B;&#x65F6;&#x95F4;">1741. &#x67E5;&#x627E;&#x6BCF;&#x4E2A;&#x5458;&#x5DE5;&#x82B1;&#x8D39;&#x7684;&#x603B;&#x65F6;&#x95F4;</a><i></i></div></li>
</ul></li>
<li><div><a href="#&#x4E03;&#x3001;&#x63A7;&#x5236;&#x6D41;">&#x4E03;&#x3001;&#x63A7;&#x5236;&#x6D41;</a><i class="level__parent level__item level__parent--opened" state="opened" onclick="var curState = this.getAttribute(&apos;state&apos;);var nextState = curState === &apos;opened&apos; ? &apos;hidden&apos; : &apos;opened&apos;;this.setAttribute(&apos;state&apos;, nextState);this.className = this.className.split(curState).join(nextState);var list = this.parentNode.nextElementSibling;if (nextState === &apos;hidden&apos;) {    list.style.display = &apos;none&apos;;} else {    list.style.display = &apos;block&apos;;}"></i></div>
<ul>
<li><div><a href="#1393-&#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;">1393. &#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;</a><i></i></div></li>
<li><div><a href="#1407-&#x6392;&#x540D;&#x9760;&#x524D;&#x7684;&#x65C5;&#x884C;&#x8005;">1407. &#x6392;&#x540D;&#x9760;&#x524D;&#x7684;&#x65C5;&#x884C;&#x8005;</a><i></i></div></li>
<li><div><a href="#1158-&#x5E02;&#x573A;&#x5206;&#x6790;-i">1158. &#x5E02;&#x573A;&#x5206;&#x6790; I</a><i></i></div></li>
<li><div><a href="#182-&#x67E5;&#x627E;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;">182. &#x67E5;&#x627E;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;</a><i></i></div></li>
<li><div><a href="#1050-&#x5408;&#x4F5C;&#x8FC7;&#x81F3;&#x5C11;&#x4E09;&#x6B21;&#x7684;&#x6F14;&#x5458;&#x548C;&#x5BFC;&#x6F14;">1050. &#x5408;&#x4F5C;&#x8FC7;&#x81F3;&#x5C11;&#x4E09;&#x6B21;&#x7684;&#x6F14;&#x5458;&#x548C;&#x5BFC;&#x6F14;</a><i></i></div></li>
<li><div><a href="#1587-&#x94F6;&#x884C;&#x8D26;&#x6237;&#x6982;&#x8981;-ii">1587. &#x94F6;&#x884C;&#x8D26;&#x6237;&#x6982;&#x8981; II</a><i></i></div></li>
<li><div><a href="#1084-&#x9500;&#x552E;&#x5206;&#x6790;iii">1084. &#x9500;&#x552E;&#x5206;&#x6790;III</a><i></i></div></li>
</ul></li>
</ul>
</div>

<h1 id="leetcode-sql-&#x5165;&#x95E8;">leetcode SQL &#x5165;&#x95E8;</h1>
<p><a href="https://leetcode.cn/study-plan/sql/?progress=6ob4kpt" target="_blank">leetcode SQL &#x5165;&#x95E8;</a></p>
<h2 id="&#x4E00;&#x3001;&#x9009;&#x62E9;">&#x4E00;&#x3001;&#x9009;&#x62E9;</h2>
<h3 id="595-&#x5927;&#x7684;&#x56FD;&#x5BB6;">595. &#x5927;&#x7684;&#x56FD;&#x5BB6;</h3>
<pre><code>SELECT
    name, population, area
FROM
    world
WHERE
    area &gt;= 3000000 OR population &gt;= 25000000
;
</code></pre><h3 id="1757-&#x53EF;&#x56DE;&#x6536;&#x4E14;&#x4F4E;&#x8102;&#x7684;&#x4EA7;&#x54C1;">1757. &#x53EF;&#x56DE;&#x6536;&#x4E14;&#x4F4E;&#x8102;&#x7684;&#x4EA7;&#x54C1;</h3>
<pre><code>select product_id
from Products
where low_fats=&apos;Y&apos;
and recyclable=&apos;Y&apos;
</code></pre><h3 id="584-&#x5BFB;&#x627E;&#x7528;&#x6237;&#x63A8;&#x8350;&#x4EBA;">584. &#x5BFB;&#x627E;&#x7528;&#x6237;&#x63A8;&#x8350;&#x4EBA;</h3>
<pre><code>SELECT name FROM customer WHERE referee_id != 2 OR referee_id IS NULL;
</code></pre><p>&#x60F3;&#x6CD5;</p>
<p>&#x6709;&#x7684;&#x4EBA;&#x4E5F;&#x8BB8;&#x4F1A;&#x975E;&#x5E38;&#x76F4;&#x89C2;&#x5730;&#x60F3;&#x5230;&#x5982;&#x4E0B;&#x89E3;&#x6CD5;&#x3002;</p>
<p>Sql</p>
<p><code>SELECT name FROM customer WHERE referee_Id &lt;&gt; 2;</code></p>
<p>&#x7136;&#x800C;&#xFF0C;&#x8FD9;&#x4E2A;&#x67E5;&#x8BE2;&#x53EA;&#x4F1A;&#x8FD4;&#x56DE;&#x4E00;&#x4E2A;&#x7ED3;&#x679C;&#xFF1A;Zach&#xFF0C;&#x5C3D;&#x7BA1;&#x4E8B;&#x5B9E;&#x4E0A;&#x6709; 4 &#x4E2A;&#x987E;&#x5BA2;&#x90FD;&#x4E0D;&#x662F; Jane &#x63A8;&#x8350;&#x7684;&#xFF08;&#x5305;&#x62EC; Jane &#x5979;&#x81EA;&#x5DF1;&#xFF09;&#x3002;&#x6240;&#x6709;&#x6CA1;&#x6709;&#x63A8;&#x8350;&#x4EBA;&#xFF08;referee_id &#x5B57;&#x6BB5;&#x503C;&#x4E3A; NULL) &#x7684;&#x5168;&#x90E8;&#x90FD;&#x6D88;&#x5931;&#x4E86;&#x3002;</p>
<p>&#x4E3A;&#x4EC0;&#x4E48;?</p>
<p>MySQL &#x4F7F;&#x7528;&#x4E09;&#x503C;&#x903B;&#x8F91; &#x2014;&#x2014; TRUE, FALSE &#x548C; UNKNOWN&#x3002;&#x4EFB;&#x4F55;&#x4E0E; NULL &#x503C;&#x8FDB;&#x884C;&#x7684;&#x6BD4;&#x8F83;&#x90FD;&#x4F1A;&#x4E0E;&#x7B2C;&#x4E09;&#x79CD;&#x503C; UNKNOWN &#x505A;&#x6BD4;&#x8F83;&#x3002;&#x8FD9;&#x4E2A;&#x201C;&#x4EFB;&#x4F55;&#x503C;&#x201D;&#x5305;&#x62EC; NULL &#x672C;&#x8EAB;&#xFF01;&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4EC0;&#x4E48; MySQL &#x63D0;&#x4F9B; IS NULL &#x548C; IS NOT NULL &#x4E24;&#x79CD;&#x64CD;&#x4F5C;&#x6765;&#x5BF9; NULL &#x7279;&#x6B8A;&#x5224;&#x65AD;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x5728; WHERE &#x8BED;&#x53E5;&#x4E2D;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x4E00;&#x4E2A;&#x989D;&#x5916;&#x7684;&#x6761;&#x4EF6;&#x5224;&#x65AD; `referee_id IS NULL&apos;&#x3002;</p>
<h3 id="183-&#x4ECE;&#x4E0D;&#x8BA2;&#x8D2D;&#x7684;&#x5BA2;&#x6237;">183. &#x4ECE;&#x4E0D;&#x8BA2;&#x8D2D;&#x7684;&#x5BA2;&#x6237;</h3>
<pre><code>select customers.name as &apos;Customers&apos;
from customers
where customers.id not in
(
    select customerid from orders
);
</code></pre><h2 id="&#x4E8C;&#x3001;&#x6392;&#x5E8F;--&#x4FEE;&#x6539;">&#x4E8C;&#x3001;&#x6392;&#x5E8F; &amp; &#x4FEE;&#x6539;</h2>
<h3 id="1873-&#x8BA1;&#x7B97;&#x7279;&#x6B8A;&#x5956;&#x91D1;">1873. &#x8BA1;&#x7B97;&#x7279;&#x6B8A;&#x5956;&#x91D1;</h3>
<p>&#x5199;&#x51FA;&#x4E00;&#x4E2A;SQL &#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#xFF0C;&#x8BA1;&#x7B97;&#x6BCF;&#x4E2A;&#x96C7;&#x5458;&#x7684;&#x5956;&#x91D1;&#x3002;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x96C7;&#x5458;&#x7684;id&#x662F;&#x5947;&#x6570;&#x5E76;&#x4E14;&#x4ED6;&#x7684;&#x540D;&#x5B57;&#x4E0D;&#x662F;&#x4EE5;&apos;M&apos;&#x5F00;&#x5934;&#xFF0C;&#x90A3;&#x4E48;&#x4ED6;&#x7684;&#x5956;&#x91D1;&#x662F;&#x4ED6;&#x5DE5;&#x8D44;&#x7684;100%&#xFF0C;&#x5426;&#x5219;&#x5956;&#x91D1;&#x4E3A;0&#x3002;</p>
<p>Return the result table ordered by employee_id.</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Employees &#x8868;:
+-------------+---------+--------+
| employee_id | name    | salary |
+-------------+---------+--------+
| 2           | Meir    | 3000   |
| 3           | Michael | 3800   |
| 7           | Addilyn | 7400   |
| 8           | Juan    | 6100   |
| 9           | Kannon  | 7700   |
+-------------+---------+--------+
&#x8F93;&#x51FA;&#xFF1A;
+-------------+-------+
| employee_id | bonus |
+-------------+-------+
| 2           | 0     |
| 3           | 0     |
| 7           | 7400  |
| 8           | 0     |
| 9           | 7700  |
+-------------+-------+
</code></pre><pre><code>select employee_id,if(employee_id % 2 != 0 and left(name,1) != &apos;M&apos;,salary,0) as bonus
from Employees
order by employee_id
&#x6216;
select 
    employee_id,
    case
        when employee_id % 2= 1 and left(name,1)!=&apos;M&apos; then salary
        else 0
    end bonus
from Employees
</code></pre><blockquote>
<p>LEFT(str, length)&#xFF1A;&#x4ECE;&#x5DE6;&#x5F00;&#x59CB;&#x622A;&#x53D6;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;length &#x662F;&#x622A;&#x53D6;&#x7684;&#x957F;&#x5EA6;&#x3002;</p>
</blockquote>
<h3 id="627-&#x53D8;&#x66F4;&#x6027;&#x522B;">627. &#x53D8;&#x66F4;&#x6027;&#x522B;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#x6765;&#x4EA4;&#x6362;&#x6240;&#x6709;&#x7684; &apos;f&apos; &#x548C; &apos;m&apos; &#xFF08;&#x5373;&#xFF0C;&#x5C06;&#x6240;&#x6709; &apos;f&apos; &#x53D8;&#x4E3A; &apos;m&apos; &#xFF0C;&#x53CD;&#x4E4B;&#x4EA6;&#x7136;&#xFF09;&#xFF0C;&#x4EC5;&#x4F7F;&#x7528; &#x5355;&#x4E2A; update &#x8BED;&#x53E5; &#xFF0C;&#x4E14;&#x4E0D;&#x4EA7;&#x751F;&#x4E2D;&#x95F4;&#x4E34;&#x65F6;&#x8868;(&#x4E0D;&#x80FD; &#x4F7F;&#x7528; select &#x8BED;&#x53E5;)&#x3002;</p>
<pre><code>update salary set sex=IF(sex=&apos;f&apos;,&apos;m&apos;,&apos;f&apos;)
&#x6216;
UPDATE salary
SET
    sex = CASE sex
        WHEN &apos;m&apos; THEN &apos;f&apos;
        ELSE &apos;m&apos;
    END;
</code></pre><hr>
<ul>
<li>case&#x8BED;&#x53E5;&#x683C;&#x5F0F;&#x4E00;</li>
</ul>
<pre><code>CASE input_expression
    WHEN expression1 THEN result_expression1
    WHEN expression2 THEN result_expression2
    [...n]
    ELSE result_expression
    END
</code></pre><p>CASE&#x8BED;&#x53E5;&#x5728;&#x6267;&#x884C;&#x65F6;&#xFF0C;&#x5C06;CASE&#x540E;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x503C;&#x4E0E;&#x5404;WHEN&#x5B50;&#x53E5;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x503C;&#x6BD4;&#x8F83;&#xFF0C;&#x5982;&#x679C;&#x76F8;&#x7B49;&#xFF0C;&#x5219;&#x6267;&#x884C;THEN&#x540E;&#x9762;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x6216;&#x8BED;&#x53E5;&#xFF0C;&#x7136;&#x540E;&#x8DF3;&#x51FA;CASE&#x8BED;&#x53E5;&#xFF1B;&#x5426;&#x5219;&#xFF0C;&#x8FD4;&#x56DE;ELSE&#x540E;&#x9762;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x3002;</p>
<ul>
<li>case&#x8BED;&#x53E5;&#x683C;&#x5F0F;&#x4E8C;</li>
</ul>
<pre><code>CASE
    WHEN expression1 THEN result_expression1
    WHEN expression2 THEN result_expression2
    [...n]
    ELSE result_expression
    END
</code></pre><p>CASE&#x540E;&#x9762;&#x6CA1;&#x6709;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x591A;&#x4E2A;WHEN&#x5B50;&#x53E5;&#x4E2D;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x4F9D;&#x6B21;&#x6267;&#x884C;&#xFF0C;&#x5982;&#x679C;&#x8868;&#x8FBE;&#x5F0F;&#x7ED3;&#x679C;&#x4E3A;&#x771F;&#xFF0C;&#x5219;&#x6267;&#x884C;&#x76F8;&#x5E94;THEN&#x5173;&#x952E;&#x5B57;&#x540E;&#x9762;&#x7684;&#x8868;&#x8FBE;&#x5F0F;&#x6216;&#x8BED;&#x53E5;&#xFF0C;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x4E4B;&#x540E;&#x8DF3;&#x51FA;CASE&#x8BED;&#x53E5;&#x3002;&#x5982;&#x679C;&#x6240;&#x6709;WHEN&#x8BED;&#x53E5;&#x90FD;&#x4E3A;FALSE&#xFF0C;&#x5219;&#x6267;&#x884C;ELSE&#x5B50;&#x53E5;&#x4E2D;&#x7684;&#x8BED;&#x53E5;&#x3002;</p>
<blockquote>
<p>&#x5C0F;tips&#xFF1A;&#x5728;&#x4EA4;&#x6362;&#x6570;&#x636E;&#x548C;&#x5217;&#x8F6C;&#x884C;&#x65F6;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x4F7F;&#x7528;case&#x8BED;&#x53E5;</p>
</blockquote>
<h3 id="196-&#x5220;&#x9664;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;">196. &#x5220;&#x9664;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;</h3>
<pre><code>delete from Person where id not in
(
    select id from 
    (
        select min(id) as id from Person group by Email 
    ) t
)
</code></pre><p>&#x7B2C;&#x4E8C;&#x5C42;&#x5D4C;&#x5957;&#x662F;&#x5FC5;&#x9700;&#x7684;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x62A5;&#x9519;&#xFF1A;</p>
<pre><code>You can&apos;t specify target table &apos;Person&apos; for update in FROM clause
</code></pre><h2 id="&#x4E09;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x51FD;&#x6570;&#x6B63;&#x5219;">&#x4E09;&#x3001;&#x5B57;&#x7B26;&#x4E32;&#x5904;&#x7406;&#x51FD;&#x6570;/&#x6B63;&#x5219;</h2>
<h3 id="1667-&#x4FEE;&#x590D;&#x8868;&#x4E2D;&#x7684;&#x540D;&#x5B57;">1667. &#x4FEE;&#x590D;&#x8868;&#x4E2D;&#x7684;&#x540D;&#x5B57;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#x6765;&#x4FEE;&#x590D;&#x540D;&#x5B57;&#xFF0C;&#x4F7F;&#x5F97;&#x53EA;&#x6709;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x662F;&#x5927;&#x5199;&#x7684;&#xFF0C;&#x5176;&#x4F59;&#x90FD;&#x662F;&#x5C0F;&#x5199;&#x7684;&#x3002;</p>
<table>
<thead>
<tr>
<th style="text-align:left">&#x51FD;&#x6570;</th>
<th style="text-align:left">&#x89E3;&#x91CA;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">CONCAT()</td>
<td style="text-align:left">&#x53EF;&#x4EE5;&#x5C06;&#x591A;&#x4E2A;&#x5B57;&#x7B26;&#x4E32;&#x62FC;&#x63A5;&#x5728;&#x4E00;&#x8D77;&#x3002;</td>
</tr>
<tr>
<td style="text-align:left">LEFT(str, length)</td>
<td style="text-align:left">&#x4ECE;&#x5DE6;&#x5F00;&#x59CB;&#x622A;&#x53D6;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;length &#x662F;&#x622A;&#x53D6;&#x7684;&#x957F;&#x5EA6;&#x3002;</td>
</tr>
<tr>
<td style="text-align:left">UPPER(str)</td>
<td style="text-align:left">&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x8F6C;&#x4E3A;&#x5927;&#x5199;</td>
</tr>
<tr>
<td style="text-align:left">LOWER(str)</td>
<td style="text-align:left">&#x5C06;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;&#x6240;&#x6709;&#x5B57;&#x7B26;&#x8F6C;&#x4E3A;&#x5C0F;&#x5199;</td>
</tr>
<tr>
<td style="text-align:left">SUBSTRING(str, begin, end)</td>
<td style="text-align:left">&#x622A;&#x53D6;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;end &#x4E0D;&#x5199;&#x9ED8;&#x8BA4;&#x4E3A;&#x7A7A;&#x3002;<strong>SUBSTRING(name, 2)</strong>&#xFF1A;&#x4ECE;&#x7B2C;&#x4E8C;&#x4E2A;&#x622A;&#x53D6;&#x5230;&#x672B;&#x5C3E;&#xFF0C;&#x6CE8;&#x610F;&#x5E76;&#x4E0D;&#x662F;&#x4E0B;&#x6807;&#xFF0C;&#x5C31;&#x662F;&#x7B2C;&#x4E8C;&#x4E2A;&#x3002;</td>
</tr>
</tbody>
</table>
<pre><code>SELECT user_id, CONCAT(UPPER(LEFT(name, 1)), LOWER(SUBSTRING(name, 2))) AS name
FROM Users
ORDER BY user_id
</code></pre><h3 id="1484-&#x6309;&#x65E5;&#x671F;&#x5206;&#x7EC4;&#x9500;&#x552E;&#x4EA7;&#x54C1;">1484. &#x6309;&#x65E5;&#x671F;&#x5206;&#x7EC4;&#x9500;&#x552E;&#x4EA7;&#x54C1;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#x6765;&#x67E5;&#x627E;&#x6BCF;&#x4E2A;&#x65E5;&#x671F;&#x3001;&#x9500;&#x552E;&#x7684;&#x4E0D;&#x540C;&#x4EA7;&#x54C1;&#x7684;&#x6570;&#x91CF;&#x53CA;&#x5176;&#x540D;&#x79F0;&#x3002;
&#x6BCF;&#x4E2A;&#x65E5;&#x671F;&#x7684;&#x9500;&#x552E;&#x4EA7;&#x54C1;&#x540D;&#x79F0;&#x5E94;&#x6309;&#x8BCD;&#x5178;&#x5E8F;&#x6392;&#x5217;&#x3002;
&#x8FD4;&#x56DE;&#x6309; sell_date &#x6392;&#x5E8F;&#x7684;&#x7ED3;&#x679C;&#x8868;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Activities &#x8868;&#xFF1A;
+------------+-------------+
| sell_date  | product     |
+------------+-------------+
| 2020-05-30 | Headphone   |
| 2020-06-01 | Pencil      |
| 2020-06-02 | Mask        |
| 2020-05-30 | Basketball  |
| 2020-06-01 | Bible       |
| 2020-06-02 | Mask        |
| 2020-05-30 | T-Shirt     |
+------------+-------------+
&#x8F93;&#x51FA;&#xFF1A;
+------------+----------+------------------------------+
| sell_date  | num_sold | products                     |
+------------+----------+------------------------------+
| 2020-05-30 | 3        | Basketball,Headphone,T-shirt |
| 2020-06-01 | 2        | Bible,Pencil                 |
| 2020-06-02 | 1        | Mask                         |
+------------+----------+------------------------------+
</code></pre><pre><code>SELECT sell_date AS &apos;sell_date&apos;,
    COUNT(DISTINCT product) AS &apos;num_sold&apos;,
    GROUP_CONCAT(DISTINCT product 
        ORDER BY product ASC    #&#x6309;&#x7167;&#x5B57;&#x5178;&#x5E8F;&#x6392;&#x5217;&#xFF0C;&#x5347;&#x5E8F;
        SEPARATOR &apos;,&apos;)          #&#x7528;&apos;,&apos;&#x5206;&#x9694;
        AS &apos;products&apos;    #&#x7EC4;&#x5185;&#x62FC;&#x63A5;
FROM Activities
GROUP BY sell_date
ORDER BY sell_date;
</code></pre><h3 id="1527-&#x60A3;&#x67D0;&#x79CD;&#x75BE;&#x75C5;&#x7684;&#x60A3;&#x8005;">1527. &#x60A3;&#x67D0;&#x79CD;&#x75BE;&#x75C5;&#x7684;&#x60A3;&#x8005;</h3>
<p><a href="https://blog.csdn.net/skyito88/article/details/124027362" target="_blank">MySQL LIKE &#x5B50;&#x53E5; &#x6A21;&#x7CCA;&#x5339;&#x914D;</a></p>
<p>%&#xFF1A;&#x8868;&#x793A;&#x4EFB;&#x610F; 0 &#x4E2A;&#x6216;&#x591A;&#x4E2A;&#x5B57;&#x7B26;&#x3002;&#x53EF;&#x5339;&#x914D;&#x4EFB;&#x610F;&#x7C7B;&#x578B;&#x548C;&#x957F;&#x5EA6;&#x7684;&#x5B57;&#x7B26;&#xFF0C;&#x6709;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x82E5;&#x662F;&#x4E2D;&#x6587;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;&#x4E24;&#x4E2A;&#x767E;&#x5206;&#x53F7;&#xFF08;%%&#xFF09;&#x8868;&#x793A;&#x3002;
_&#xFF1A;&#x8868;&#x793A;&#x4EFB;&#x610F;&#x5355;&#x4E2A;&#x5B57;&#x7B26;&#x3002;&#x5339;&#x914D;&#x5355;&#x4E2A;&#x4EFB;&#x610F;&#x5B57;&#x7B26;&#xFF0C;&#x5B83;&#x5E38;&#x7528;&#x6765;&#x9650;&#x5236;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x5B57;&#x7B26;&#x957F;&#x5EA6;&#x8BED;&#x53E5;&#x3002;</p>
<pre><code>select patient_id, patient_name, conditions
from patients
where conditions like &apos;% DIAB1%&apos;
or conditions like &apos;DIAB1%&apos;
</code></pre><h2 id="&#x56DB;&#x3001;&#x7EC4;&#x5408;&#x67E5;&#x8BE2;--&#x6307;&#x5B9A;&#x9009;&#x53D6;">&#x56DB;&#x3001;&#x7EC4;&#x5408;&#x67E5;&#x8BE2; &amp; &#x6307;&#x5B9A;&#x9009;&#x53D6;</h2>
<h3 id="1965-&#x4E22;&#x5931;&#x4FE1;&#x606F;&#x7684;&#x96C7;&#x5458;">1965. &#x4E22;&#x5931;&#x4FE1;&#x606F;&#x7684;&#x96C7;&#x5458;</h3>
<p>&#x5199;&#x51FA;&#x4E00;&#x4E2A;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#xFF0C;&#x627E;&#x5230;&#x6240;&#x6709; &#x4E22;&#x5931;&#x4FE1;&#x606F; &#x7684;&#x96C7;&#x5458;id&#x3002;&#x5F53;&#x6EE1;&#x8DB3;&#x4E0B;&#x9762;&#x4E00;&#x4E2A;&#x6761;&#x4EF6;&#x65F6;&#xFF0C;&#x5C31;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;&#x96C7;&#x5458;&#x7684;&#x4FE1;&#x606F;&#x4E22;&#x5931;&#xFF1A;</p>
<ul>
<li>&#x96C7;&#x5458;&#x7684; &#x59D3;&#x540D; &#x4E22;&#x5931;&#x4E86;&#xFF0C;</li>
<li>&#x6216;&#x8005;&#x96C7;&#x5458;&#x7684; &#x85AA;&#x6C34;&#x4FE1;&#x606F; &#x4E22;&#x5931;&#x4E86;&#xFF0C;</li>
</ul>
<p>&#x8FD4;&#x56DE;&#x8FD9;&#x4E9B;&#x96C7;&#x5458;&#x7684;employee_id &#xFF0C; &#x4ECE;&#x5C0F;&#x5230;&#x5927;&#x6392;&#x5E8F; &#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Employees table:
+-------------+----------+
| employee_id | name     |
+-------------+----------+
| 2           | Crew     |
| 4           | Haven    |
| 5           | Kristian |
+-------------+----------+
Salaries table:
+-------------+--------+
| employee_id | salary |
+-------------+--------+
| 5           | 76071  |
| 1           | 22517  |
| 4           | 63539  |
+-------------+--------+
&#x8F93;&#x51FA;&#xFF1A;
+-------------+
| employee_id |
+-------------+
| 1           |
| 2           |
+-------------+
</code></pre><p><strong>&#x89E3;&#x7B54;1&#xFF1A;</strong></p>
<p>&#x4F20;&#x7EDF;&#x5916;&#x8FDE;&#x63A5;&#xFF0C;<a href="https://qgao233.github.io/qgaoMajorKnowledge/chapter8/section6/" target="_blank">&#x53C2;&#x8003;</a></p>
<pre><code>SELECT
    temp.employee_id AS employee_id
FROM(   
    SELECT
        e.employee_id
        FROM
        employees e
        LEFT JOIN salaries s ON e.employee_id = s.employee_id
        WHERE
        s.salary IS NULL
    UNION
    SELECT
        s.employee_id
        FROM
        salaries s
        LEFT JOIN employees e ON s.employee_id = e.employee_id
        WHERE
        e.name IS NULL
    ) AS temp
ORDER BY temp.employee_id
</code></pre><p><strong>&#x89E3;&#x7B54;2&#xFF1A;</strong></p>
<p>&#x96C7;&#x5458;&#x7684;&#x59D3;&#x540D;&#x4E22;&#x5931;&#x4E86;&#x6216;&#x8005;&#x96C7;&#x5458;&#x7684;&#x85AA;&#x6C34;&#x4FE1;&#x606F;&#x4E22;&#x5931;&#xFF0C;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;employee_id &#x5728; employees &#x548C;salaries &#x7684;&#x5E76;&#x96C6;&#x8868;&#x91CC;&#x9762;&#x4EC5;&#x51FA;&#x73B0;&#x4E00;&#x6B21;</p>
<pre><code>select 
    employee_id 
from 
    (
    select employee_id from employees
    union all 
    select employee_id from salaries
) as t
group by 
    employee_id
having 
    count(employee_id) = 1
order by 
    employee_id;
</code></pre><h3 id="1795-&#x6BCF;&#x4E2A;&#x4EA7;&#x54C1;&#x5728;&#x4E0D;&#x540C;&#x5546;&#x5E97;&#x7684;&#x4EF7;&#x683C;">1795. &#x6BCF;&#x4E2A;&#x4EA7;&#x54C1;&#x5728;&#x4E0D;&#x540C;&#x5546;&#x5E97;&#x7684;&#x4EF7;&#x683C;</h3>
<p><strong>&#x884C;&#x5217;&#x8F6C;&#x6362;</strong></p>
<p><img src="media/1.png" alt=""></p>
<p>&#x3010;&#x884C;&#x8F6C;&#x5217;&#x2014;&#x2014;MAX/SUM+CASE WHEN+GROUP BY&#x3011;</p>
<pre><code>SELECT name,
  MAX(CASE WHEN subject=&apos;&#x8BED;&#x6587;&apos; THEN score ELSE 0 END) AS &quot;&#x8BED;&#x6587;&quot;,
  MAX(CASE WHEN subject=&apos;&#x6570;&#x5B66;&apos; THEN score ELSE 0 END) AS &quot;&#x6570;&#x5B66;&quot;,
  MAX(CASE WHEN subject=&apos;&#x82F1;&#x8BED;&apos; THEN score ELSE 0 END) AS &quot;&#x82F1;&#x8BED;&quot;
FROM student1
GROUP BY name
</code></pre><p>&#x3010;&#x5217;&#x8F6C;&#x884C;&#x2014;&#x2014;MAX+UNION+GROUP BY&#x3011;</p>
<pre><code>SELECT NAME,&apos;&#x8BED;&#x6587;&apos; AS subject,MAX(&quot;&#x8BED;&#x6587;&quot;) AS score
FROM student2 GROUP BY NAME
UNION
SELECT NAME,&apos;&#x6570;&#x5B66;&apos; AS subject,MAX(&quot;&#x6570;&#x5B66;&quot;) AS score
FROM student2 GROUP BY NAME
UNION
SELECT NAME,&apos;&#x82F1;&#x8BED;&apos; AS subject,MAX(&quot;&#x82F1;&#x8BED;&quot;) AS score
FROM student2 GROUP BY NAME
</code></pre><p><strong>&#x9898;&#x76EE;&#xFF1A;</strong></p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Products table:
+------------+--------+--------+--------+
| product_id | store1 | store2 | store3 |
+------------+--------+--------+--------+
| 0          | 95     | 100    | 105    |
| 1          | 70     | null   | 80     |
+------------+--------+--------+--------+
&#x8F93;&#x51FA;&#xFF1A;
+------------+--------+-------+
| product_id | store  | price |
+------------+--------+-------+
| 0          | store1 | 95    |
| 0          | store2 | 100   |
| 0          | store3 | 105   |
| 1          | store1 | 70    |
| 1          | store3 | 80    |
+------------+--------+-------+
</code></pre><p><strong>&#x89E3;&#x7B54;&#xFF1A;</strong></p>
<pre><code>select product_id,&apos;store1&apos; store,store1 price
from Products where store1 is not null
group by 1
union all
select product_id,&apos;store2&apos; store,store2 price
from Products where store2 is not null
group by 1
union all
select product_id,&apos;store3&apos; store,store3 price
from Products where store3 is not null
group by 1
</code></pre><blockquote>
<p>union &#x548C; union all &#x7684;&#x533A;&#x522B;&#x662F;&#xFF0C;union &#x4F1A;&#x81EA;&#x52A8;&#x538B;&#x7F29;&#x591A;&#x4E2A;&#x7ED3;&#x679C;&#x96C6;&#x5408;&#x4E2D;&#x7684;&#x91CD;&#x590D;&#x7ED3;&#x679C;&#xFF0C;&#x800C; union all &#x5219;&#x5C06;&#x6240;&#x6709;&#x7684;&#x7ED3;&#x679C;&#x5168;&#x90E8;&#x663E;&#x793A;&#x51FA;&#x6765;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x4E0D;&#x662F;&#x91CD;&#x590D;&#x3002;</p>
</blockquote>
<h3 id="608-&#x6811;&#x8282;&#x70B9;">608. &#x6811;&#x8282;&#x70B9;</h3>
<p><strong>&#x9898;&#x76EE;&#xFF1A;</strong></p>
<p>&#x5199;&#x4E00;&#x4E2A;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#xFF0C;&#x8F93;&#x51FA;&#x6240;&#x6709;&#x8282;&#x70B9;&#x7684;&#x7F16;&#x53F7;&#x548C;&#x8282;&#x70B9;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x6309;&#x7167;&#x8282;&#x70B9;&#x7F16;&#x53F7;&#x6392;&#x5E8F;&#x3002;</p>
<p>&#x6811;&#x4E2D;&#x6BCF;&#x4E2A;&#x8282;&#x70B9;&#x5C5E;&#x4E8E;&#x4EE5;&#x4E0B;&#x4E09;&#x79CD;&#x7C7B;&#x578B;&#x4E4B;&#x4E00;&#xFF1A;</p>
<ul>
<li>&#x53F6;&#x5B50;&#xFF1A;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5B69;&#x5B50;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x6839;&#xFF1A;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x662F;&#x6574;&#x68F5;&#x6811;&#x7684;&#x6839;&#xFF0C;&#x5373;&#x6CA1;&#x6709;&#x7236;&#x8282;&#x70B9;&#x3002;</li>
<li>&#x5185;&#x90E8;&#x8282;&#x70B9;&#xFF1A;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x8282;&#x70B9;&#x65E2;&#x4E0D;&#x662F;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x4E5F;&#x4E0D;&#x662F;&#x6839;&#x8282;&#x70B9;&#x3002;</li>
</ul>
<pre><code>&#x8F93;&#x5165;
+----+------+
| id | p_id |
+----+------+
| 1  | null |
| 2  | 1    |
| 3  | 1    |
| 4  | 2    |
| 5  | 2    |
+----+------+
&#x8F93;&#x51FA;
+----+------+
| id | Type |
+----+------+
| 1  | Root |
| 2  | Inner|
| 3  | Leaf |
| 4  | Leaf |
| 5  | Leaf |
+----+------+
</code></pre><p><strong>&#x89E3;&#x7B54;&#xFF1A;</strong></p>
<p><a href="https://qgao233.github.io/qgaoMajorKnowledge/chapter8/section6/" target="_blank">&#x53C2;&#x8003;</a></p>
<pre><code># &#x6839;&#x8282;&#x70B9;
SELECT A.id, &apos;Root&apos; AS &apos;Type&apos;
FROM tree AS A
WHERE A.p_id IS NULL

UNION

# &#x53F6;&#x5B50;&#x8282;&#x70B9;
# &#x6838;&#x5FC3;&#x601D;&#x60F3;&#x5C31;&#x662F;&#x770B;&#xFF1A;A&#x4E2D;&#x7684;id&#x6709;&#x6CA1;&#x6709;&#x5F53;&#x8FC7;&#x7236;&#x4EB2;
# &#x4E3A;&#x4E86;&#x6392;&#x9664;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x7684;&#x60C5;&#x51B5;&#xFF08;&#x6839;&#x8282;&#x70B9;&#xFF09;&#xFF0C;&#x52A0;&#x4E86; A.p_id IS NOT NULL
SELECT A.id, &apos;Leaf&apos; AS &apos;Type&apos;
FROM tree AS A LEFT JOIN tree AS B
  ON A.id = B.p_id
WHERE B.p_id IS NULL AND A.p_id IS NOT NULL

UNION

# &#x5185;&#x90E8;&#x8282;&#x70B9;
SELECT A.id, &apos;Inner&apos; AS &apos;Type&apos;
FROM tree AS A LEFT JOIN tree AS B
  ON A.id = B.p_id
WHERE B.p_id IS NOT NULL AND A.p_id IS NOT NULL

ORDER BY id
;
</code></pre><h3 id="176-&#x7B2C;&#x4E8C;&#x9AD8;&#x7684;&#x85AA;&#x6C34;">176. &#x7B2C;&#x4E8C;&#x9AD8;&#x7684;&#x85AA;&#x6C34;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#xFF0C;&#x83B7;&#x53D6;&#x5E76;&#x8FD4;&#x56DE; Employee &#x8868;&#x4E2D;&#x7B2C;&#x4E8C;&#x9AD8;&#x7684;&#x85AA;&#x6C34; &#x3002;&#x5982;&#x679C;&#x4E0D;&#x5B58;&#x5728;&#x7B2C;&#x4E8C;&#x9AD8;&#x7684;&#x85AA;&#x6C34;&#xFF0C;&#x67E5;&#x8BE2;&#x5E94;&#x8BE5;&#x8FD4;&#x56DE; null &#x3002;</p>
<pre><code>&#x793A;&#x4F8B; 1&#xFF1A;

&#x8F93;&#x5165;&#xFF1A;
Employee &#x8868;&#xFF1A;
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
&#x8F93;&#x51FA;&#xFF1A;
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+

&#x793A;&#x4F8B; 2&#xFF1A;

&#x8F93;&#x5165;&#xFF1A;
Employee &#x8868;&#xFF1A;
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
&#x8F93;&#x51FA;&#xFF1A;
+---------------------+
| SecondHighestSalary |
+---------------------+
| null                |
+---------------------+
</code></pre><pre><code>&#x56E0;&#x4E3A;&#x672C;&#x8868;&#x53EF;&#x80FD;&#x53EA;&#x6709;&#x4E00;&#x9879;&#x8BB0;&#x5F55;&#x3002;&#x4E3A;&#x4E86;&#x514B;&#x670D;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C06;&#x5176;&#x4F5C;&#x4E3A;&#x4E34;&#x65F6;&#x8868;&#x3002;
SELECT
    (SELECT DISTINCT
            Salary
        FROM
            Employee
        ORDER BY Salary DESC
        LIMIT 1 OFFSET 1) AS SecondHighestSalary
;

&#x6216;
SELECT
    IFNULL(
      (SELECT DISTINCT Salary
       FROM Employee
       ORDER BY Salary DESC
        LIMIT 1 OFFSET 1),
    NULL) AS SecondHighestSalary

&#x6216;mysql oracle&#x901A;&#x7528;
select max(Salary) SecondHighestSalary 
from Employee
where Salary &lt; (select max(Salary) from Employee)
</code></pre><h2 id="&#x4E94;&#x3001;&#x5408;&#x5E76;">&#x4E94;&#x3001;&#x5408;&#x5E76;</h2>
<h3 id="175-&#x7EC4;&#x5408;&#x4E24;&#x4E2A;&#x8868;">175. &#x7EC4;&#x5408;&#x4E24;&#x4E2A;&#x8868;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A;SQL&#x67E5;&#x8BE2;&#x6765;&#x62A5;&#x544A; Person &#x8868;&#x4E2D;&#x6BCF;&#x4E2A;&#x4EBA;&#x7684;&#x59D3;&#x3001;&#x540D;&#x3001;&#x57CE;&#x5E02;&#x548C;&#x5DDE;&#x3002;&#x5982;&#x679C; personId &#x7684;&#x5730;&#x5740;&#x4E0D;&#x5728; Address &#x8868;&#x4E2D;&#xFF0C;&#x5219;&#x62A5;&#x544A;&#x4E3A;&#x7A7A;  null &#x3002;</p>
<pre><code>&#x8F93;&#x5165;: 
Person&#x8868;:
+----------+----------+-----------+
| personId | lastName | firstName |
+----------+----------+-----------+
| 1        | Wang     | Allen     |
| 2        | Alice    | Bob       |
+----------+----------+-----------+
Address&#x8868;:
+-----------+----------+---------------+------------+
| addressId | personId | city          | state      |
+-----------+----------+---------------+------------+
| 1         | 2        | New York City | New York   |
| 2         | 3        | Leetcode      | California |
+-----------+----------+---------------+------------+
&#x8F93;&#x51FA;: 
+-----------+----------+---------------+----------+
| firstName | lastName | city          | state    |
+-----------+----------+---------------+----------+
| Allen     | Wang     | Null          | Null     |
| Bob       | Alice    | New York City | New York |
+-----------+----------+---------------+----------+
</code></pre><pre><code>select FirstName, LastName, City, State
from Person left join Address
on Person.PersonId = Address.PersonId
</code></pre><h3 id="1581-&#x8FDB;&#x5E97;&#x5374;&#x672A;&#x8FDB;&#x884C;&#x8FC7;&#x4EA4;&#x6613;&#x7684;&#x987E;&#x5BA2;">1581. &#x8FDB;&#x5E97;&#x5374;&#x672A;&#x8FDB;&#x884C;&#x8FC7;&#x4EA4;&#x6613;&#x7684;&#x987E;&#x5BA2;</h3>
<p>&#x6709;&#x4E00;&#x4E9B;&#x987E;&#x5BA2;&#x53EF;&#x80FD;&#x5149;&#x987E;&#x4E86;&#x8D2D;&#x7269;&#x4E2D;&#x5FC3;&#x4F46;&#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x4EA4;&#x6613;&#x3002;&#x8BF7;&#x4F60;&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#xFF0C;&#x6765;&#x67E5;&#x627E;&#x8FD9;&#x4E9B;&#x987E;&#x5BA2;&#x7684; ID &#xFF0C;&#x4EE5;&#x53CA;&#x4ED6;&#x4EEC;&#x53EA;&#x5149;&#x987E;&#x4E0D;&#x4EA4;&#x6613;&#x7684;&#x6B21;&#x6570;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x4EE5; &#x4EFB;&#x4F55;&#x987A;&#x5E8F; &#x6392;&#x5E8F;&#x7684;&#x7ED3;&#x679C;&#x8868;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;:
Visits
+----------+-------------+
| visit_id | customer_id |
+----------+-------------+
| 1        | 23          |
| 2        | 9           |
| 4        | 30          |
| 5        | 54          |
| 6        | 96          |
| 7        | 54          |
| 8        | 54          |
+----------+-------------+
Transactions
+----------------+----------+--------+
| transaction_id | visit_id | amount |
+----------------+----------+--------+
| 2              | 5        | 310    |
| 3              | 5        | 300    |
| 9              | 5        | 200    |
| 12             | 1        | 910    |
| 13             | 2        | 970    |
+----------------+----------+--------+
&#x8F93;&#x51FA;:
+-------------+----------------+
| customer_id | count_no_trans |
+-------------+----------------+
| 54          | 2              |
| 30          | 1              |
| 96          | 1              |
+-------------+----------------+
</code></pre><pre><code>SELECT 
    customer_id, COUNT(customer_id) count_no_trans
FROM 
    visits v
LEFT JOIN 
    transactions t ON v.visit_id = t.visit_id
WHERE amount IS NULL
GROUP BY customer_id;
</code></pre><h3 id="1148-&#x6587;&#x7AE0;&#x6D4F;&#x89C8;-i">1148. &#x6587;&#x7AE0;&#x6D4F;&#x89C8; I</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x6761; SQL &#x67E5;&#x8BE2;&#x4EE5;&#x627E;&#x51FA;&#x6240;&#x6709;&#x6D4F;&#x89C8;&#x8FC7;&#x81EA;&#x5DF1;&#x6587;&#x7AE0;&#x7684;&#x4F5C;&#x8005;&#xFF0C;&#x7ED3;&#x679C;&#x6309;&#x7167; id &#x5347;&#x5E8F;&#x6392;&#x5217;&#x3002;</p>
<pre><code>Views &#x8868;&#xFF1A;
+------------+-----------+-----------+------------+
| article_id | author_id | viewer_id | view_date  |
+------------+-----------+-----------+------------+
| 1          | 3         | 5         | 2019-08-01 |
| 1          | 3         | 6         | 2019-08-02 |
| 2          | 7         | 7         | 2019-08-01 |
| 2          | 7         | 6         | 2019-08-02 |
| 4          | 7         | 1         | 2019-07-22 |
| 3          | 4         | 4         | 2019-07-21 |
| 3          | 4         | 4         | 2019-07-21 |
+------------+-----------+-----------+------------+

&#x7ED3;&#x679C;&#x8868;&#xFF1A;
+------+
| id   |
+------+
| 4    |
| 7    |
+------+
</code></pre><pre><code>SELECT DISTINCT author_id AS id
FROM  Views
WHERE author_id = viewer_id
ORDER BY author_id
</code></pre><h3 id="197-&#x4E0A;&#x5347;&#x7684;&#x6E29;&#x5EA6;">197. &#x4E0A;&#x5347;&#x7684;&#x6E29;&#x5EA6;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#xFF0C;&#x6765;&#x67E5;&#x627E;&#x4E0E;&#x4E4B;&#x524D;&#xFF08;&#x6628;&#x5929;&#x7684;&#xFF09;&#x65E5;&#x671F;&#x76F8;&#x6BD4;&#x6E29;&#x5EA6;&#x66F4;&#x9AD8;&#x7684;&#x6240;&#x6709;&#x65E5;&#x671F;&#x7684; id &#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Weather &#x8868;&#xFF1A;
+----+------------+-------------+
| id | recordDate | Temperature |
+----+------------+-------------+
| 1  | 2015-01-01 | 10          |
| 2  | 2015-01-02 | 25          |
| 3  | 2015-01-03 | 20          |
| 4  | 2015-01-04 | 30          |
+----+------------+-------------+
&#x8F93;&#x51FA;&#xFF1A;
+----+
| id |
+----+
| 2  |
| 4  |
+----+
</code></pre><ul>
<li>datediff(&#x65E5;&#x671F;1, &#x65E5;&#x671F;2)&#xFF1A;
&#x5F97;&#x5230;&#x7684;&#x7ED3;&#x679C;&#x662F;&#x65E5;&#x671F;1&#x4E0E;&#x65E5;&#x671F;2&#x76F8;&#x5DEE;&#x7684;&#x5929;&#x6570;&#x3002;
&#x5982;&#x679C;&#x65E5;&#x671F;1&#x6BD4;&#x65E5;&#x671F;2&#x5927;&#xFF0C;&#x7ED3;&#x679C;&#x4E3A;&#x6B63;&#xFF1B;&#x5982;&#x679C;&#x65E5;&#x671F;1&#x6BD4;&#x65E5;&#x671F;2&#x5C0F;&#xFF0C;&#x7ED3;&#x679C;&#x4E3A;&#x8D1F;&#x3002;</li>
</ul>
<pre><code>SELECT
    weather.id AS &apos;Id&apos;
FROM
    weather
       inner JOIN
    weather w ON DATEDIFF(weather.recordDate , w.recordDate ) = 1
        AND weather.Temperature &gt; w.Temperature
</code></pre><h3 id="607-&#x9500;&#x552E;&#x5458;">607. &#x9500;&#x552E;&#x5458;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A;SQL&#x67E5;&#x8BE2;&#xFF0C;&#x62A5;&#x544A;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x4E0E;&#x540D;&#x4E3A; &#x201C;RED&#x201D; &#x7684;&#x516C;&#x53F8;&#x76F8;&#x5173;&#x7684;&#x8BA2;&#x5355;&#x7684;&#x6240;&#x6709;&#x9500;&#x552E;&#x4EBA;&#x5458;&#x7684;&#x59D3;&#x540D;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
SalesPerson &#x8868;:
+----------+------+--------+-----------------+------------+
| sales_id | name | salary | commission_rate | hire_date  |
+----------+------+--------+-----------------+------------+
| 1        | John | 100000 | 6               | 4/1/2006   |
| 2        | Amy  | 12000  | 5               | 5/1/2010   |
| 3        | Mark | 65000  | 12              | 12/25/2008 |
| 4        | Pam  | 25000  | 25              | 1/1/2005   |
| 5        | Alex | 5000   | 10              | 2/3/2007   |
+----------+------+--------+-----------------+------------+
Company &#x8868;:
+--------+--------+----------+
| com_id | name   | city     |
+--------+--------+----------+
| 1      | RED    | Boston   |
| 2      | ORANGE | New York |
| 3      | YELLOW | Boston   |
| 4      | GREEN  | Austin   |
+--------+--------+----------+
Orders &#x8868;:
+----------+------------+--------+----------+--------+
| order_id | order_date | com_id | sales_id | amount |
+----------+------------+--------+----------+--------+
| 1        | 1/1/2014   | 3      | 4        | 10000  |
| 2        | 2/1/2014   | 4      | 5        | 5000   |
| 3        | 3/1/2014   | 1      | 1        | 50000  |
| 4        | 4/1/2014   | 1      | 4        | 25000  |
+----------+------------+--------+----------+--------+
&#x8F93;&#x51FA;&#xFF1A;
+------+
| name |
+------+
| Amy  |
| Mark |
| Alex |
+------+
</code></pre><pre><code>SELECT
    s.name
FROM
    salesperson s
WHERE
    s.sales_id NOT IN (SELECT
            o.sales_id
        FROM
            orders o
                LEFT JOIN
            company c ON o.com_id = c.com_id
        WHERE
            c.name = &apos;RED&apos;)
</code></pre><h2 id="&#x516D;&#x3001;&#x8BA1;&#x7B97;&#x51FD;&#x6570;">&#x516D;&#x3001;&#x8BA1;&#x7B97;&#x51FD;&#x6570;</h2>
<h3 id="1141-&#x67E5;&#x8BE2;&#x8FD1;30&#x5929;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6570;">1141. &#x67E5;&#x8BE2;&#x8FD1;30&#x5929;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6570;</h3>
<p>&#x8BF7;&#x5199;SQL&#x67E5;&#x8BE2;&#x51FA;&#x622A;&#x81F3; 2019-07-27&#xFF08;&#x5305;&#x542B;2019-07-27&#xFF09;&#xFF0C;&#x8FD1; 30 &#x5929;&#x7684;&#x6BCF;&#x65E5;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#x6570;&#xFF08;&#x5F53;&#x5929;&#x53EA;&#x8981;&#x6709;&#x4E00;&#x6761;&#x6D3B;&#x52A8;&#x8BB0;&#x5F55;&#xFF0C;&#x5373;&#x4E3A;&#x6D3B;&#x8DC3;&#x7528;&#x6237;&#xFF09;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Activity table:
+---------+------------+---------------+---------------+
| user_id | session_id | activity_date | activity_type |
+---------+------------+---------------+---------------+
| 1       | 1          | 2019-07-20    | open_session  |
| 1       | 1          | 2019-07-20    | scroll_down   |
| 1       | 1          | 2019-07-20    | end_session   |
| 2       | 4          | 2019-07-20    | open_session  |
| 2       | 4          | 2019-07-21    | send_message  |
| 2       | 4          | 2019-07-21    | end_session   |
| 3       | 2          | 2019-07-21    | open_session  |
| 3       | 2          | 2019-07-21    | send_message  |
| 3       | 2          | 2019-07-21    | end_session   |
| 4       | 3          | 2019-06-25    | open_session  |
| 4       | 3          | 2019-06-25    | end_session   |
+---------+------------+---------------+---------------+
&#x8F93;&#x51FA;&#xFF1A;
+------------+--------------+ 
| day        | active_users |
+------------+--------------+ 
| 2019-07-20 | 2            |
| 2019-07-21 | 2            |
+------------+--------------+
</code></pre><p>datediff&#x8FD8;&#x8981;&#x9650;&#x5236;&gt;=0&#x4E0D;&#x7136;&#x4F1A;&#x67E5;&#x8BE2;&#x5230;07-27&#x4E4B;&#x540E;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<pre><code>select activity_date day, count(distinct user_id) active_users
from activity
where datediff(&apos;2019-07-27&apos;, activity_date) &gt;= 0 AND datediff(&apos;2019-07-27&apos;, activity_date) &lt;30
group by activity_date
</code></pre><h3 id="1693-&#x6BCF;&#x5929;&#x7684;&#x9886;&#x5BFC;&#x548C;&#x5408;&#x4F19;&#x4EBA;">1693. &#x6BCF;&#x5929;&#x7684;&#x9886;&#x5BFC;&#x548C;&#x5408;&#x4F19;&#x4EBA;</h3>
<p>&#x5199;&#x4E00;&#x6761; SQL &#x8BED;&#x53E5;&#xFF0C;&#x4F7F;&#x5F97;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x4E2A; date_id &#x548C; make_name&#xFF0C;&#x8FD4;&#x56DE;&#x4E0D;&#x540C;&#x7684; lead_id &#x4EE5;&#x53CA;&#x4E0D;&#x540C;&#x7684; partner_id &#x7684;&#x6570;&#x91CF;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
DailySales &#x8868;&#xFF1A;
+-----------+-----------+---------+------------+
| date_id   | make_name | lead_id | partner_id |
+-----------+-----------+---------+------------+
| 2020-12-8 | toyota    | 0       | 1          |
| 2020-12-8 | toyota    | 1       | 0          |
| 2020-12-8 | toyota    | 1       | 2          |
| 2020-12-7 | toyota    | 0       | 2          |
| 2020-12-7 | toyota    | 0       | 1          |
| 2020-12-8 | honda     | 1       | 2          |
| 2020-12-8 | honda     | 2       | 1          |
| 2020-12-7 | honda     | 0       | 1          |
| 2020-12-7 | honda     | 1       | 2          |
| 2020-12-7 | honda     | 2       | 1          |
+-----------+-----------+---------+------------+
&#x8F93;&#x51FA;&#xFF1A;
+-----------+-----------+--------------+-----------------+
| date_id   | make_name | unique_leads | unique_partners |
+-----------+-----------+--------------+-----------------+
| 2020-12-8 | toyota    | 2            | 3               |
| 2020-12-7 | toyota    | 1            | 2               |
| 2020-12-8 | honda     | 2            | 2               |
| 2020-12-7 | honda     | 3            | 2               |
+-----------+-----------+--------------+-----------------+
</code></pre><pre><code>SELECT 
    date_id,
    make_name,
    COUNT(DISTINCT lead_id)  unique_leads,
    COUNT(DISTINCT partner_id) unique_partners
FROM 
    DailySales
GROUP BY 
    date_id, make_name;
</code></pre><h3 id="1729-&#x6C42;&#x5173;&#x6CE8;&#x8005;&#x7684;&#x6570;&#x91CF;">1729. &#x6C42;&#x5173;&#x6CE8;&#x8005;&#x7684;&#x6570;&#x91CF;</h3>
<p>&#x5199;&#x51FA; SQL &#x8BED;&#x53E5;&#xFF0C;&#x5BF9;&#x4E8E;&#x6BCF;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#xFF0C;&#x8FD4;&#x56DE;&#x8BE5;&#x7528;&#x6237;&#x7684;&#x5173;&#x6CE8;&#x8005;&#x6570;&#x91CF;&#x3002;</p>
<p>&#x6309; user_id &#x7684;&#x987A;&#x5E8F;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;&#x8868;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Followers &#x8868;&#xFF1A;
+---------+-------------+
| user_id | follower_id |
+---------+-------------+
| 0       | 1           |
| 1       | 0           |
| 2       | 0           |
| 2       | 1           |
+---------+-------------+
&#x8F93;&#x51FA;&#xFF1A;
+---------+----------------+
| user_id | followers_count|
+---------+----------------+
| 0       | 1              |
| 1       | 1              |
| 2       | 2              |
+---------+----------------+
</code></pre><pre><code>select 
    user_id, COUNT(*) followers_count
from 
    followers
 group by user_id
 order by user_id;
</code></pre><h3 id="586-&#x8BA2;&#x5355;&#x6700;&#x591A;&#x7684;&#x5BA2;&#x6237;">586. &#x8BA2;&#x5355;&#x6700;&#x591A;&#x7684;&#x5BA2;&#x6237;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A;SQL&#x67E5;&#x8BE2;&#xFF0C;&#x4E3A;&#x4E0B;&#x4E86; &#x6700;&#x591A;&#x8BA2;&#x5355; &#x7684;&#x5BA2;&#x6237;&#x67E5;&#x627E; customer_number &#x3002;</p>
<blockquote>
<p>&#x6D4B;&#x8BD5;&#x7528;&#x4F8B;&#x751F;&#x6210;&#x540E;&#xFF0C; &#x6070;&#x597D;&#x6709;&#x4E00;&#x4E2A;&#x5BA2;&#x6237; &#x6BD4;&#x4EFB;&#x4F55;&#x5176;&#x4ED6;&#x5BA2;&#x6237;&#x4E0B;&#x4E86;&#x66F4;&#x591A;&#x7684;&#x8BA2;&#x5355;&#x3002;</p>
</blockquote>
<pre><code>&#x8F93;&#x5165;: 
Orders &#x8868;:
+--------------+-----------------+
| order_number | customer_number |
+--------------+-----------------+
| 1            | 1               |
| 2            | 2               |
| 3            | 3               |
| 4            | 3               |
+--------------+-----------------+
&#x8F93;&#x51FA;: 
+-----------------+
| customer_number |
+-----------------+
| 3               |
+-----------------+
</code></pre><pre><code>SELECT
    customer_number
FROM
    orders
GROUP BY customer_number
ORDER BY COUNT(*) DESC
LIMIT 1
</code></pre><h3 id="511-&#x6E38;&#x620F;&#x73A9;&#x6CD5;&#x5206;&#x6790;-i">511. &#x6E38;&#x620F;&#x73A9;&#x6CD5;&#x5206;&#x6790; I</h3>
<p>&#x5199;&#x4E00;&#x6761; SQL &#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x83B7;&#x53D6;&#x6BCF;&#x4F4D;&#x73A9;&#x5BB6; &#x7B2C;&#x4E00;&#x6B21;&#x767B;&#x9646;&#x5E73;&#x53F0;&#x7684;&#x65E5;&#x671F;&#x3002;</p>
<pre><code>Activity &#x8868;&#xFF1A;
+-----------+-----------+------------+--------------+
| player_id | device_id | event_date | games_played |
+-----------+-----------+------------+--------------+
| 1         | 2         | 2016-03-01 | 5            |
| 1         | 2         | 2016-05-02 | 6            |
| 2         | 3         | 2017-06-25 | 1            |
| 3         | 1         | 2016-03-02 | 0            |
| 3         | 4         | 2018-07-03 | 5            |
+-----------+-----------+------------+--------------+

Result &#x8868;&#xFF1A;
+-----------+-------------+
| player_id | first_login |
+-----------+-------------+
| 1         | 2016-03-01  |
| 2         | 2017-06-25  |
| 3         | 2016-03-02  |
+-----------+-------------+
</code></pre><pre><code>select 
    player_id,
    min(event_date) first_login
from activity
group by player_id
</code></pre><h3 id="1890-2020&#x5E74;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x767B;&#x5F55;">1890. 2020&#x5E74;&#x6700;&#x540E;&#x4E00;&#x6B21;&#x767B;&#x5F55;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#xFF0C;&#x8BE5;&#x67E5;&#x8BE2;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x5728; 2020 &#x5E74;&#x767B;&#x5F55;&#x8FC7;&#x7684;&#x6240;&#x6709;&#x7528;&#x6237;&#x7684;&#x672C;&#x5E74;&#x5EA6; &#x6700;&#x540E;&#x4E00;&#x6B21; &#x767B;&#x5F55;&#x65F6;&#x95F4;&#x3002;&#x7ED3;&#x679C;&#x96C6; &#x4E0D; &#x5305;&#x542B; 2020 &#x5E74;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#x8FC7;&#x7684;&#x7528;&#x6237;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Logins &#x8868;:
+---------+---------------------+
| user_id | time_stamp          |
+---------+---------------------+
| 6       | 2020-06-30 15:06:07 |
| 6       | 2021-04-21 14:06:06 |
| 6       | 2019-03-07 00:18:15 |
| 8       | 2020-02-01 05:10:53 |
| 8       | 2020-12-30 00:46:50 |
| 2       | 2020-01-16 02:49:50 |
| 2       | 2019-08-25 07:59:08 |
| 14      | 2019-07-14 09:00:00 |
| 14      | 2021-01-06 11:59:59 |
+---------+---------------------+
&#x8F93;&#x51FA;&#xFF1A;
+---------+---------------------+
| user_id | last_stamp          |
+---------+---------------------+
| 6       | 2020-06-30 15:06:07 |
| 8       | 2020-12-30 00:46:50 |
| 2       | 2020-01-16 02:49:50 |
+---------+---------------------+
</code></pre><pre><code>SELECT 
    user_id, max(time_stamp) last_stamp
FROM 
    Logins
WHERE 
    year(time_stamp) = &apos;2020&apos;
GROUP BY 
    user_id;
&#x6216;
select user_id, max(time_stamp) as last_stamp
from Logins
where time_stamp&gt;=&apos;2020-01-01&apos; and time_stamp&lt;&apos;2021-01-01&apos;
group by user_id
</code></pre><h3 id="1741-&#x67E5;&#x627E;&#x6BCF;&#x4E2A;&#x5458;&#x5DE5;&#x82B1;&#x8D39;&#x7684;&#x603B;&#x65F6;&#x95F4;">1741. &#x67E5;&#x627E;&#x6BCF;&#x4E2A;&#x5458;&#x5DE5;&#x82B1;&#x8D39;&#x7684;&#x603B;&#x65F6;&#x95F4;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A;SQL&#x67E5;&#x8BE2;&#x4EE5;&#x8BA1;&#x7B97;&#x6BCF;&#x4F4D;&#x5458;&#x5DE5;&#x6BCF;&#x5929;&#x5728;&#x529E;&#x516C;&#x5BA4;&#x82B1;&#x8D39;&#x7684;&#x603B;&#x65F6;&#x95F4;&#xFF08;&#x4EE5;&#x5206;&#x949F;&#x4E3A;&#x5355;&#x4F4D;&#xFF09;&#x3002; &#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x5728;&#x4E00;&#x5929;&#x4E4B;&#x5185;&#xFF0C;&#x540C;&#x4E00;&#x5458;&#x5DE5;&#x662F;&#x53EF;&#x4EE5;&#x591A;&#x6B21;&#x8FDB;&#x5165;&#x548C;&#x79BB;&#x5F00;&#x529E;&#x516C;&#x5BA4;&#x7684;&#x3002; &#x5728;&#x529E;&#x516C;&#x5BA4;&#x91CC;&#x4E00;&#x6B21;&#x8FDB;&#x51FA;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#x4E3A;out_time &#x51CF;&#x53BB; in_time&#x3002;</p>
<pre><code>Employees table:
+--------+------------+---------+----------+
| emp_id | event_day  | in_time | out_time |
+--------+------------+---------+----------+
| 1      | 2020-11-28 | 4       | 32       |
| 1      | 2020-11-28 | 55      | 200      |
| 1      | 2020-12-03 | 1       | 42       |
| 2      | 2020-11-28 | 3       | 33       |
| 2      | 2020-12-09 | 47      | 74       |
+--------+------------+---------+----------+
Result table:
+------------+--------+------------+
| day        | emp_id | total_time |
+------------+--------+------------+
| 2020-11-28 | 1      | 173        |
| 2020-11-28 | 2      | 30         |
| 2020-12-03 | 1      | 41         |
| 2020-12-09 | 2      | 27         |
+------------+--------+------------+
</code></pre><pre><code>SELECT 
    event_day AS day,
    emp_id,
    sum(out_time-in_time) AS total_time 
FROM Employees
GROUP BY event_day,emp_id;
</code></pre><h2 id="&#x4E03;&#x3001;&#x63A7;&#x5236;&#x6D41;">&#x4E03;&#x3001;&#x63A7;&#x5236;&#x6D41;</h2>
<h3 id="1393-&#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;">1393. &#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A;SQL&#x67E5;&#x8BE2;&#x6765;&#x62A5;&#x544A;&#x6BCF;&#x652F;&#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;&#x3002;</p>
<p>&#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;&#x662F;&#x4E00;&#x6B21;&#x6216;&#x591A;&#x6B21;&#x4E70;&#x5356;&#x80A1;&#x7968;&#x540E;&#x7684;&#x5168;&#x90E8;&#x6536;&#x76CA;&#x6216;&#x635F;&#x5931;&#x3002;</p>
<pre><code>Stocks &#x8868;:
+---------------+-----------+---------------+--------+
| stock_name    | operation | operation_day | price  |
+---------------+-----------+---------------+--------+
| Leetcode      | Buy       | 1             | 1000   |
| Corona Masks  | Buy       | 2             | 10     |
| Leetcode      | Sell      | 5             | 9000   |
| Handbags      | Buy       | 17            | 30000  |
| Corona Masks  | Sell      | 3             | 1010   |
| Corona Masks  | Buy       | 4             | 1000   |
| Corona Masks  | Sell      | 5             | 500    |
| Corona Masks  | Buy       | 6             | 1000   |
| Handbags      | Sell      | 29            | 7000   |
| Corona Masks  | Sell      | 10            | 10000  |
+---------------+-----------+---------------+--------+

Result &#x8868;:
+---------------+-------------------+
| stock_name    | capital_gain_loss |
+---------------+-------------------+
| Corona Masks  | 9500              |
| Leetcode      | 8000              |
| Handbags      | -23000            |
+---------------+-------------------+
</code></pre><pre><code>SELECT stock_name,
        SUM(
            CASE operation WHEN &apos;sell&apos;   #&#x5982;&#x679C;&#x6211;&#x4EEC;&#x7684;&#x64CD;&#x4F5C;&#x662F;&#x5356;&#x51FA;
            THEN price ELSE -price   #&#x90A3;&#x4E48;&#x8FD4;&#x56DE;&#x6211;&#x4EEC;&#x7684;&#x5230;&#x7684;&#x6536;&#x76CA;&#xFF0C;&#x53CD;&#x4E4B;&#xFF0C;&#x64CD;&#x4F5C;&#x662F;&#x4E70;&#x5165;&#xFF0C;&#x8FD4;&#x56DE;&#x652F;&#x51FA;
            END                  
           ) AS capital_gain_loss      #&#x8BA1;&#x7B97;&#x5356;&#x51FA;&#x548C;&#x4E70;&#x5165;&#x5DEE;&#x503C;&#x7684;&#x548C;
FROM Stocks
GROUP BY stock_name  #&#x8981;&#x62A5;&#x544A;&#x6BCF;&#x53EA;&#x80A1;&#x7968;&#x7684;&#x8D44;&#x672C;&#x635F;&#x76CA;&#xFF0C;&#x9700;&#x8981;&#x5BF9;&#x80A1;&#x7968;&#x8FDB;&#x884C;&#x5206;&#x7EC4;
</code></pre><h3 id="1407-&#x6392;&#x540D;&#x9760;&#x524D;&#x7684;&#x65C5;&#x884C;&#x8005;">1407. &#x6392;&#x540D;&#x9760;&#x524D;&#x7684;&#x65C5;&#x884C;&#x8005;</h3>
<p>&#x5199;&#x4E00;&#x6BB5; SQL , &#x62A5;&#x544A;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x65C5;&#x884C;&#x8DDD;&#x79BB;&#x3002;</p>
<p>&#x8FD4;&#x56DE;&#x7684;&#x7ED3;&#x679C;&#x8868;&#x5355;&#xFF0C;&#x4EE5; travelled_distance &#x964D;&#x5E8F;&#x6392;&#x5217; &#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E24;&#x4E2A;&#x6216;&#x8005;&#x66F4;&#x591A;&#x7684;&#x7528;&#x6237;&#x65C5;&#x884C;&#x4E86;&#x76F8;&#x540C;&#x7684;&#x8DDD;&#x79BB;, &#x90A3;&#x4E48;&#x518D;&#x4EE5; name &#x5347;&#x5E8F;&#x6392;&#x5217; &#x3002;</p>
<pre><code>Users &#x8868;&#xFF1A;
+------+-----------+
| id   | name      |
+------+-----------+
| 1    | Alice     |
| 2    | Bob       |
| 3    | Alex      |
| 4    | Donald    |
| 7    | Lee       |
| 13   | Jonathan  |
| 19   | Elvis     |
+------+-----------+

Rides &#x8868;&#xFF1A;
+------+----------+----------+
| id   | user_id  | distance |
+------+----------+----------+
| 1    | 1        | 120      |
| 2    | 2        | 317      |
| 3    | 3        | 222      |
| 4    | 7        | 100      |
| 5    | 13       | 312      |
| 6    | 19       | 50       |
| 7    | 7        | 120      |
| 8    | 19       | 400      |
| 9    | 7        | 230      |
+------+----------+----------+

Result &#x8868;&#xFF1A;
+----------+--------------------+
| name     | travelled_distance |
+----------+--------------------+
| Elvis    | 450                |
| Lee      | 450                |
| Bob      | 317                |
| Jonathan | 312                |
| Alex     | 222                |
| Alice    | 120                |
| Donald   | 0                  |
+----------+--------------------+
</code></pre><pre><code>select u.name,if(sum(distance) is null,0,sum(distance)) as travelled_distance 
from users u left join rides r on u.id = r.user_id
group by u.id
order by travelled_distance desc,u.name
</code></pre><h3 id="1158-&#x5E02;&#x573A;&#x5206;&#x6790;-i">1158. &#x5E02;&#x573A;&#x5206;&#x6790; I</h3>
<p>&#x5199;&#x51FA;&#x4E00;&#x6761;SQL&#x8BED;&#x53E5;&#x4EE5;&#x67E5;&#x8BE2;&#x6BCF;&#x4E2A;&#x7528;&#x6237;&#x7684;&#x6CE8;&#x518C;&#x65E5;&#x671F;&#x548C;&#x5728; 2019 &#x5E74;&#x4F5C;&#x4E3A;&#x4E70;&#x5BB6;&#x7684;&#x8BA2;&#x5355;&#x603B;&#x6570;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Users &#x8868;:
+---------+------------+----------------+
| user_id | join_date  | favorite_brand |
+---------+------------+----------------+
| 1       | 2018-01-01 | Lenovo         |
| 2       | 2018-02-09 | Samsung        |
| 3       | 2018-01-19 | LG             |
| 4       | 2018-05-21 | HP             |
+---------+------------+----------------+
Orders &#x8868;:
+----------+------------+---------+----------+-----------+
| order_id | order_date | item_id | buyer_id | seller_id |
+----------+------------+---------+----------+-----------+
| 1        | 2019-08-01 | 4       | 1        | 2         |
| 2        | 2018-08-02 | 2       | 1        | 3         |
| 3        | 2019-08-03 | 3       | 2        | 3         |
| 4        | 2018-08-04 | 1       | 4        | 2         |
| 5        | 2018-08-04 | 1       | 3        | 4         |
| 6        | 2019-08-05 | 2       | 2        | 4         |
+----------+------------+---------+----------+-----------+
Items &#x8868;:
+---------+------------+
| item_id | item_brand |
+---------+------------+
| 1       | Samsung    |
| 2       | Lenovo     |
| 3       | LG         |
| 4       | HP         |
+---------+------------+
&#x8F93;&#x51FA;&#xFF1A;
+-----------+------------+----------------+
| buyer_id  | join_date  | orders_in_2019 |
+-----------+------------+----------------+
| 1         | 2018-01-01 | 1              |
| 2         | 2018-02-09 | 2              |
| 3         | 2018-01-19 | 0              |
| 4         | 2018-05-21 | 0              |
+-----------+------------+----------------+
</code></pre><p>Items&#x8868;&#x662F;&#x8BEF;&#x5BFC;&#x7684;&#x3002;</p>
<pre><code>select u.user_id as buyer_id, join_date ,ifnull(count(order_id),0) 
orders_in_2019 
from Users u left join Orders o on u.user_id=o. buyer_id and year(order_date)=2019
group by u.user_id;
</code></pre><h3 id="182-&#x67E5;&#x627E;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;">182. &#x67E5;&#x627E;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A; SQL &#x67E5;&#x8BE2;&#xFF0C;&#x67E5;&#x627E; Person &#x8868;&#x4E2D;&#x6240;&#x6709;&#x91CD;&#x590D;&#x7684;&#x7535;&#x5B50;&#x90AE;&#x7BB1;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;
+----+---------+
| Id | Email   |
+----+---------+
| 1  | a@b.com |
| 2  | c@d.com |
| 3  | a@b.com |
+----+---------+
&#x8F93;&#x51FA;
+---------+
| Email   |
+---------+
| a@b.com |
+---------+
</code></pre><pre><code>select Email
from Person
group by Email
having count(Email) &gt; 1;
</code></pre><h3 id="1050-&#x5408;&#x4F5C;&#x8FC7;&#x81F3;&#x5C11;&#x4E09;&#x6B21;&#x7684;&#x6F14;&#x5458;&#x548C;&#x5BFC;&#x6F14;">1050. &#x5408;&#x4F5C;&#x8FC7;&#x81F3;&#x5C11;&#x4E09;&#x6B21;&#x7684;&#x6F14;&#x5458;&#x548C;&#x5BFC;&#x6F14;</h3>
<p>&#x5199;&#x4E00;&#x6761;SQL&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x83B7;&#x53D6;&#x5408;&#x4F5C;&#x8FC7;&#x81F3;&#x5C11;&#x4E09;&#x6B21;&#x7684;&#x6F14;&#x5458;&#x548C;&#x5BFC;&#x6F14;&#x7684; id &#x5BF9; (actor_id, director_id)</p>
<pre><code>ActorDirector &#x8868;&#xFF1A;
+-------------+-------------+-------------+
| actor_id    | director_id | timestamp   |
+-------------+-------------+-------------+
| 1           | 1           | 0           |
| 1           | 1           | 1           |
| 1           | 1           | 2           |
| 1           | 2           | 3           |
| 1           | 2           | 4           |
| 2           | 1           | 5           |
| 2           | 1           | 6           |
+-------------+-------------+-------------+

Result &#x8868;&#xFF1A;
+-------------+-------------+
| actor_id    | director_id |
+-------------+-------------+
| 1           | 1           |
+-------------+-------------+
</code></pre><pre><code>SELECT 
    actor_id, director_id
FROM 
    actordirector
GROUP BY actor_id, director_id
HAVING COUNT(*) &gt;= 3;
</code></pre><h3 id="1587-&#x94F6;&#x884C;&#x8D26;&#x6237;&#x6982;&#x8981;-ii">1587. &#x94F6;&#x884C;&#x8D26;&#x6237;&#x6982;&#x8981; II</h3>
<p>&#x5199;&#x4E00;&#x4E2A; SQL,  &#x62A5;&#x544A;&#x4F59;&#x989D;&#x9AD8;&#x4E8E; 10000 &#x7684;&#x6240;&#x6709;&#x7528;&#x6237;&#x7684;&#x540D;&#x5B57;&#x548C;&#x4F59;&#x989D;. &#x8D26;&#x6237;&#x7684;&#x4F59;&#x989D;&#x7B49;&#x4E8E;&#x5305;&#x542B;&#x8BE5;&#x8D26;&#x6237;&#x7684;&#x6240;&#x6709;&#x4EA4;&#x6613;&#x7684;&#x603B;&#x548C;.</p>
<pre><code>Users table:
+------------+--------------+
| account    | name         |
+------------+--------------+
| 900001     | Alice        |
| 900002     | Bob          |
| 900003     | Charlie      |
+------------+--------------+

Transactions table:
+------------+------------+------------+---------------+
| trans_id   | account    | amount     | transacted_on |
+------------+------------+------------+---------------+
| 1          | 900001     | 7000       |  2020-08-01   |
| 2          | 900001     | 7000       |  2020-09-01   |
| 3          | 900001     | -3000      |  2020-09-02   |
| 4          | 900002     | 1000       |  2020-09-12   |
| 5          | 900003     | 6000       |  2020-08-07   |
| 6          | 900003     | 6000       |  2020-09-07   |
| 7          | 900003     | -4000      |  2020-09-11   |
+------------+------------+------------+---------------+

Result table:
+------------+------------+
| name       | balance    |
+------------+------------+
| Alice      | 11000      |
+------------+------------+
</code></pre><pre><code>select name,sum(Transactions.amount) as  balance from Users left join Transactions 
on Users.account=Transactions.account group by Users.account having balance&gt;10000
</code></pre><h3 id="1084-&#x9500;&#x552E;&#x5206;&#x6790;iii">1084. &#x9500;&#x552E;&#x5206;&#x6790;III</h3>
<p>&#x7F16;&#x5199;&#x4E00;&#x4E2A;SQL&#x67E5;&#x8BE2;&#xFF0C;&#x62A5;&#x544A;2019&#x5E74;&#x6625;&#x5B63;&#x624D;&#x552E;&#x51FA;&#x7684;&#x4EA7;&#x54C1;&#x3002;&#x5373;&#x4EC5;&#x5728;2019-01-01&#x81F3;2019-03-31&#xFF08;&#x542B;&#xFF09;&#x4E4B;&#x95F4;&#x5356;&#x51FA;&#x53BB;&#x7684;&#x5546;&#x54C1;&#x3002;</p>
<blockquote>
<p>&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x4E0D;&#x4EC5;&#x5728;&#x8303;&#x56F4;&#x5185;&#x5356;&#x51FA;&#xFF0C;&#x8FD8;&#x5728;&#x8303;&#x56F4;&#x5916;&#x4E5F;&#x5356;&#x51FA;&#xFF0C;&#x5219;&#x4E0D;&#x7B97;&#x3002;</p>
</blockquote>
<pre><code>&#x8F93;&#x5165;&#xFF1A;
Product table:
+------------+--------------+------------+
| product_id | product_name | unit_price |
+------------+--------------+------------+
| 1          | S8           | 1000       |
| 2          | G4           | 800        |
| 3          | iPhone       | 1400       |
+------------+--------------+------------+
Sales table:
+-----------+------------+----------+------------+----------+-------+
| seller_id | product_id | buyer_id | sale_date  | quantity | price |
+-----------+------------+----------+------------+----------+-------+
| 1         | 1          | 1        | 2019-01-21 | 2        | 2000  |
| 1         | 2          | 2        | 2019-02-17 | 1        | 800   |
| 2         | 2          | 3        | 2019-06-02 | 1        | 800   |
| 3         | 3          | 4        | 2019-05-13 | 2        | 2800  |
+-----------+------------+----------+------------+----------+-------+
&#x8F93;&#x51FA;&#xFF1A;
+-------------+--------------+
| product_id  | product_name |
+-------------+--------------+
| 1           | S8           |
+-------------+--------------+
</code></pre><pre><code>&#x6162;&#xFF1A;
SELECT s.product_id, product_name
FROM Sales s
JOIN Product p
ON s.product_id = p.product_id
GROUP BY s.product_id
HAVING MIN(sale_date) &gt;= &apos;2019-01-01&apos; AND MAX(sale_date) &lt;= &apos;2019-03-31&apos;

&#x5FEB;&#xFF1A;
select product_id, product_name
from product
where product_id not in (
    select product_id
    from sales
    where sale_date &gt;= &apos;2019-04-01&apos; or sale_date &lt; &apos;2019-01-01&apos;)
</code></pre><footer class="page-footer"><span class="copyright">Copyright &#xA9; qgao 2021-* all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x8BE5;&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2022-07-15 23:36:50
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"leetcode SQL 入门","level":"1.8.1","depth":2,"previous":{"title":"7. sql练习","level":"1.8","depth":1,"ref":"","articles":[{"title":"leetcode SQL 入门","level":"1.8.1","depth":2,"path":"mysql/leetcode1/index.md","ref":"mysql/leetcode1/index.md","articles":[]}]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["-lunr","-search","search-pro","back-to-top-button","chapter-fold","code","splitter","tbfed-pagefooter","page-treeview","popup","expandable-chapters","-sharing","sharing-plus","page-toc-button"],"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy qgao 2021-*","modify_label":"该文件修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"page-treeview":{"collapsed":false,"copyright":"Copyright &#169; qgao 2021-*","minHeaderCount":"2","minHeaderDeep":"2"},"chapter-fold":{},"splitter":{},"search-pro":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"popup":{},"code":{"copyButtons":true},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"page-toc-button":{"maxTocDepth":4,"minTocSize":2},"back-to-top-button":{},"sharing":{"douban":true,"facebook":true,"google":true,"qq":true,"twitter":true,"weibo":true},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"mysql/leetcode1/index.md","mtime":"2022-07-15T15:36:50.839Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-07-15T15:37:00.039Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

